[![INFORMS Journal on Computing Logo](https://INFORMSJoC.github.io/logos/INFORMS_Journal_on_Computing_Header.jpg)](https://pubsonline.informs.org/journal/ijoc)

# Alternating minimization for square root principal component pursuit

This archive is distributed in association with the [INFORMS Journal on Computing](https://pubsonline.informs.org/journal/ijoc) under the [MIT License](LICENSE).

The software and data in this repository are a snapshot of the software and data that were used in the research reported in the paper [Alternating minimization for square root principal component pursuit](https://doi.org/10.1287/ijoc.2025.1105) by Shengxiang Deng, Xudong Li, and Yangjing Zhang.

**Important: This project is under active development. The official and most up-to-date version of this code is maintained at the [GitHub repository](https://github.com/MatOpt/srPCP_code). For the latest updates, bug reports, or support requests, please visit the repository and use the issue tracker.**

## Cite

To cite the contents of this repository, please cite both the paper and this repo, using their respective DOIs.
- https://doi.org/10.1287/ijoc.2025.1105

- https://doi.org/10.1287/ijoc.2025.1105.cd

Below is the BibTex for citing this snapshot of the repository.

```
@misc{deng2025alternating,
  author =        {Shengxiang Deng and Xudong Li and Yangjing Zhang},
  publisher =     {INFORMS Journal on Computing},
  title =         {Alternating minimization for square root principal component pursuit}, 
  year =          {2025},
  doi =           {https://doi.org/10.1287/ijoc.2025.1105.cd},
  url =           {https://github.com/INFORMSJoC/2025.1105}, 
  note =          {Available for download at https://github.com/INFORMSJoC/2025.1105},
} 
```

## Description
The goal of this software is to demonstrate the effectiveness of our `AltMin` and `Acc_AltMin` methods proposed in this paper for solving the square root principal component pursuit problem.

## Data
The data used in this paper consists of two parts:
- **Synthetic data**: Generated by the execution scripts in the `scripts` folder
- **Real-world data**: Primarily sourced from the dataset provided in:  
  > Chen C, Chen Q, Do MN, Koltun V (2019) Seeing Motion in the Dark. *Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)*, 3185-3194.
The dataset is available at:  
[https://github.com/cchen156/Seeing-Motion-in-the-Dark](https://github.com/cchen156/Seeing-Motion-in-the-Dark)  
*Note: Due to file size limitations, we do not directly provide the dataset here.*


## Code
This code can be run in MATLAB R2024a.

This directory contains the folders `src` and `scripts`:
* `src`: includes the source code of the paper. See `src/README.md` for a description of this folder. This folder is organized as follows:
  * `src/AltMin.m`: the code  for solving the square root principal component pursuit (srPCP) problem:
``min_{L,S} \|L\|_* + lambda \|S\|_1 + mu \|L+S-D\|_F`` 
  by both the Alternating Minimization method (`AltMin`) and its accelerated version (`Acc_AltMin`) in the paper. `Acc_AltMin` is implemented through the same function by modifying the input `options` parameter (specifically `update_method` and `acceleration_rank`).

  * `src/UpdateL.m`: the code for updating `L` in the paper.
  * `src/UpdateS.m`: the code for updating `S` in the paper.
  * `src/UpdateS_sub.m`: the code for updating `S` subproblem:
  ``min_s ||s-a||_2 + lambda*||s||_1, given a \in R^n`` in the paper.
* `scripts`: contains the scripts used to replicate the experiments in the paper. See the *Replicating* section below for details.


## Results
The results are presented in the numerical experiments section of the paper. 

The results are presented across multiple files containing numerical experiments and figures:

### Figure Files
* `windmill/` folder:
  - It contains image files showing decomposition results of selected frames from the windmill video dataset, presented in `Figure 1` in the paper, using the AltMin algorithm. 
  - The folder includes 15 PNG images representing different components for the 30th, 60th, and 90th frames of the video:
    - Original frames: origin30.png, origin60.png, origin90.png
    - Background components (L): Lbar30.png, Lbar60.png, Lbar90.png
    - Foreground components (S): Sbar30.png, Sbar60.png, Sbar90.png
    - Denoised images (L+S): LSbar30.png, LSbar60.png, LSbar90.png
    - Estimated noise components (Z = D-L-S): Z30.png, Z60.png, Z90.png

* `rank_identification.eps`: 
  It is `Figure 2` in the paper.
  
### Data Files
* `table1_result.txt`: Comparison of `AltMin` vs `ADMM` methods with columns:
  - method, dimension (dim), rank (r), noise level
  - objective value (obj), computation time (time)
  - etaL and etaS values

* `table2_result.txt`: Extended method comparison with additional columns:
  - method, parameter ($\mu$), dimension (dim), rank (r), noise level
  - objective value (obj), computation time (time)
  - SVD  and sorting time 
  - Includes dimensions up to 50,000
  - Shows time differences between `AltMin`, `Acc_AltMin`, and `ADMM` methods

* `table3_result.txt`: Instance-specific results with columns:
  - Name (e.g., M0008), Time, Objective value,  Iteration count, and Dimension

* `table4_result.txt`: Rank analysis with columns:
  - Name, Time, Dimension, SVD time, Sorting time, and Final rank

## Replicating


* To replicate the results in the section "Synthetic data" in the paper, please run `scripts/run_table1.m` and `scripts/run_table2.m`. The results obtained will be stored in `results` folder.
* To replicate the results in the section "Real data from dark raw videos" in the paper, please run `scripts/run_table3.m` and `scripts/run_table4.m`. The results obtained will be stored in  `results` folder.
* To replicate the result in the `Figure 1` in the paper, please run `scripts/run_fig1.m`.
* To replicate the result in the `Figure 2` in the paper, please run `scripts/run_fig2.m`.

Note: The code in `scripts/root_pcp_code/` directory is adapted from the official implementation of the following paper:

> Zhang J, Yan J, Wright J (2021) Square Root Principal Component Pursuit: Tuning-Free Noisy Robust Matrix Recovery. *Advances in Neural Information Processing Systems 34*: 29464â€“29475.

The original source code was obtained from the paper's [supplementary material](https://openreview.net/attachment?id=NNZ0caVe2ak&name=supplementary_material).
We have made minor modifications to the `root_pcp.m` file to extract additional outputs required for our project.

## Support

For questions, bug reports, or feature requests, please file an issue through the GitHub [issue tracker](https://github.com/MatOpt/srPCP_code/issues/new).

This project is under active development. You can follow its progress at [GitHub repository](https://github.com/MatOpt/srPCP_code).
